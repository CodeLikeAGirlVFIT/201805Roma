if (self.CavalryLogger) { CavalryLogger.start_js(["h6qWg"]); }

__d("ProfileVideoPlayerController",["Arbiter","Event","Parent","TimeSlice","VideoPlayerReason","destroyOnUnload","getViewportDimensions","setTimeout","tidyEvent"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){"use strict";__p&&__p();this.$1=a;this.$2=c;this.$3=!1;this.$5();var d=b("Parent").byTag(a.getRootNode(),"a")||a.getRootNode();d&&b("tidyEvent")(b("Event").listen(d,"mouseover",this.resetPlaybackTimer.bind(this)));c&&c.isHovercard&&a.addListener("stateChange",function(){!this.$4&&a.isState("paused")&&(this.$4=b("Arbiter").subscribe("Hovercard/show",function(){a.isState("paused")&&this.isVisible()&&this.play(b("VideoPlayerReason").AUTOPLAY)}.bind(this)))}.bind(this));b("destroyOnUnload")(function(){return this.$4&&this.$4.unsubscribe()}.bind(this))}a.prototype.isVisible=function(){"use strict";if(this.$1.isFullscreen())return!0;var a=b("getViewportDimensions")().height,c=this.getDOMPosition();if(c.height===0)return!1;var d=c.y;c=c.y+c.height;return d<0||c>=a?!1:!0};a.prototype.play=function(a){"use strict";this.$3||this.$1.play(a)};a.prototype.pause=function(a){"use strict";this.$1.pause(a)};a.prototype.getDOMPosition=function(){"use strict";return this.$1.getDOMPosition()};a.prototype.$5=function(){"use strict";this.$2&&this.$2.playback_limit_ms&&b("setTimeout")(b("TimeSlice").guard(function(){this.$6()}.bind(this),"ProfileVideoPlayerController startPlaybackTimer",{propagationType:b("TimeSlice").PropagationType.EXECUTION}),this.$2.playback_limit_ms)};a.prototype.resetPlaybackTimer=function(){"use strict";this.$3&&(this.$3=!1,this.play(b("VideoPlayerReason").AUTOPLAY),this.$5())};a.prototype.$6=function(){"use strict";this.pause(b("VideoPlayerReason").AUTOPLAY),this.$3=!0};a.prototype.getPausedPermanently=function(){"use strict";return this.$3};e.exports=a}),null);
__d("ProfileVideoManager",["Arbiter","DesktopHscrollUnitEventConstants","Event","ProfileVideoPlayerController","SubscriptionsHandler","VideoPlayerReason","Visibility","destroyOnUnload","throttle"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=500;i.registerVideo=function(a,c){"use strict";g||(g=new i(c));a=new(b("ProfileVideoPlayerController"))(a,c);g.addVideoUnit(a);a.isVisible()&&g.updateAutoplay()};function i(a){"use strict";this.$1=a.interval?a.interval:h,this.$2=[],this.$5=[],this.$3=null,this.$4=new(b("SubscriptionsHandler"))(),this.$4.addSubscriptions(b("Event").listen(window,"resize",this.updateAutoplay.bind(this)),b("Event").listen(window,"blur",this.$7.bind(this)),b("Event").listen(window,"focus",this.$8.bind(this)),b("Visibility").addListener(b("Visibility").HIDDEN,this.$7.bind(this)),b("Visibility").addListener(b("Visibility").VISIBLE,this.$8.bind(this)),b("Arbiter").subscribe(b("DesktopHscrollUnitEventConstants").HSCROLL_ITEM_SHOWN_EVENT,this.updateAutoplay.bind(this))),this.$3=b("Event").listen(window,"scroll",b("throttle")(this.updateAutoplay.bind(this),this.$1)),b("destroyOnUnload")(function(){this.$5=[],this.$2=[],this.$3&&this.$3.remove(),this.$3=null,this.$4.release()}.bind(this))}i.prototype.getVideoUnits=function(){"use strict";return this.$5};i.prototype.addVideoUnit=function(a){"use strict";this.$5.push(a),this.$6&&a.pause(b("VideoPlayerReason").PAGE_VISIBILITY),this.updateAutoplay()};i.prototype.getPlayingVideoUnits=function(){"use strict";return this.$2};i.prototype.getVisibleUnits=function(){"use strict";var a=[];this.$5.forEach(function(b){b.isVisible()&&a.push(b)});return a};i.prototype.updateAutoplay=function(){"use strict";var a=this.getPlayingVideoUnits(),c=this.getVisibleUnits();this.$6?(a.forEach(function(a){a.pause(b("VideoPlayerReason").PAGE_VISIBILITY)}),this.$2=[]):(a.forEach(function(a){c.indexOf(a)===-1&&a.pause(b("VideoPlayerReason").AUTOPLAY)}),c.forEach(function(c){a.indexOf(c)===-1&&c.play(b("VideoPlayerReason").AUTOPLAY)}),this.$2=c)};i.prototype.$7=function(){"use strict";this.getPlayingVideoUnits().forEach(function(a){a.pause(b("VideoPlayerReason").PAGE_VISIBILITY)}),this.$6=!0,this.$2=[]};i.prototype.$8=function(){"use strict";this.$6=!1,this.updateAutoplay()};e.exports=i}),null);